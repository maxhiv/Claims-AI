(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[720],{6611:function(e,t,r){Promise.resolve().then(r.bind(r,3299))},3299:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(7437),a=r(2265),o=r(7138);let s=[{key:"Intake",title:"Intake",color:"bg-gray-100"},{key:"Contacted",title:"Contacted",color:"bg-blue-100"},{key:"Inspection Scheduled",title:"Inspection Scheduled",color:"bg-yellow-100"},{key:"Inspection Completed",title:"Inspection Completed",color:"bg-orange-100"},{key:"Estimate Written",title:"Estimate Written",color:"bg-purple-100"},{key:"Carrier Approval Pending",title:"Carrier Approval Pending",color:"bg-pink-100"},{key:"Carrier Approved",title:"Carrier Approved",color:"bg-green-100"},{key:"Closed",title:"Closed",color:"bg-green-200"}];function i(e){let{claims:t,onClaimStageUpdate:r}=e,[o,i]=(0,a.useState)(null),[l,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(!0),u=(0,a.useRef)(null),g=e=>t.filter(t=>t.stage===e),p=(e,t)=>{i(t),e.dataTransfer.effectAllowed="move"},x=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},h=(e,n)=>{if(e.preventDefault(),o&&o.stage!==n){let e=t.map(e=>e.claimNumber===o.claimNumber?{...e,stage:n}:e);null==r||r(e),console.log("Moving claim ".concat(o.claimNumber," from ").concat(o.stage," to ").concat(n))}i(null)},b=()=>{if(u.current){let{scrollLeft:e,scrollWidth:t,clientWidth:r}=u.current;c(e>0),m(e<t-r-1)}},y=e=>e?e>=80?"border-red-300 border-l-4 border-l-red-500":e>=60?"border-orange-300 border-l-4 border-l-orange-500":"border-green-300 border-l-4 border-l-green-500":"border-gray-200";return(0,a.useEffect)(()=>{let e=setTimeout(()=>{b()},100);return()=>clearTimeout(e)},[t]),(0,n.jsxs)("div",{className:"w-full h-full bg-gray-50 p-6",children:[(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Claims Kanban Board"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Drag and drop claims between workflow stages"})]}),(0,n.jsxs)("div",{className:"flex justify-end gap-2 mb-4",children:[(0,n.jsx)("button",{onClick:()=>{u.current&&(u.current.scrollBy({left:-320,behavior:"smooth"}),b())},disabled:!l,className:"px-3 py-2 rounded-lg border ".concat(l?"bg-white text-gray-700 hover:bg-gray-50 border-gray-300":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"),children:"← Left"}),(0,n.jsx)("button",{onClick:()=>{u.current&&(u.current.scrollBy({left:320,behavior:"smooth"}),b())},disabled:!d,className:"px-3 py-2 rounded-lg border ".concat(d?"bg-white text-gray-700 hover:bg-gray-50 border-gray-300":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"),children:"Right →"})]}),(0,n.jsx)("div",{ref:u,className:"flex gap-6 overflow-x-auto pb-6",onScroll:b,children:s.map(e=>{let t=g(e.key);return(0,n.jsxs)("div",{className:"min-w-80 ".concat(e.color," rounded-lg p-4"),onDragOver:x,onDrop:t=>h(t,e.key),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"font-semibold text-gray-800",children:e.title}),(0,n.jsx)("span",{className:"bg-white px-2 py-1 rounded-full text-sm font-medium text-gray-600",children:t.length})]}),(0,n.jsxs)("div",{className:"space-y-3 min-h-96",children:[t.map((t,r)=>(0,n.jsxs)("div",{draggable:!0,onDragStart:e=>p(e,t),className:"bg-white rounded-lg p-4 shadow-sm cursor-grab active:cursor-grabbing hover:shadow-md transition-shadow ".concat(y(t.priorityScore)),children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900 text-sm",children:t.name}),t.priorityScore&&(0,n.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(t.priorityScore>=80?"bg-red-100 text-red-800":t.priorityScore>=60?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"),children:t.priorityScore})]}),(0,n.jsxs)("div",{className:"space-y-1 text-xs text-gray-600",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Claim:"})," ",t.claimNumber]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Peril:"})," ",t.peril]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Carrier:"})," ",t.carrier]}),(0,n.jsx)("div",{className:"text-gray-500 truncate",children:t.location})]}),t.hasAppointment&&(0,n.jsxs)("div",{className:"mt-3 p-2 bg-blue-50 rounded text-xs",children:[(0,n.jsxs)("div",{className:"font-medium text-blue-800",children:["\uD83D\uDCC5 ",t.appointmentDate]}),(0,n.jsx)("div",{className:"text-blue-600",children:t.appointmentTime}),(0,n.jsx)("span",{className:"inline-block mt-1 px-2 py-1 rounded text-xs ".concat("confirmed"===t.appointmentStatus?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:t.appointmentStatus})]}),!t.hasAppointment&&"Intake"!==e.key&&(0,n.jsx)("div",{className:"mt-3 p-2 bg-orange-50 rounded text-xs",children:(0,n.jsx)("div",{className:"font-medium text-orange-800",children:"⏳ Needs Scheduling"})}),t.notes.length>0&&(0,n.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["\uD83D\uDCAC ",t.notes[0].substring(0,50),"..."]})]},"".concat(t.claimNumber,"-").concat(r))),0===t.length&&(0,n.jsx)("div",{className:"text-center text-gray-400 py-8 text-sm",children:"No claims in this stage"})]})]},e.key)})})]})}var l=r(5591);function c(){let[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)(!0),c="a1234567-e89b-12d3-a456-426614174000";return((0,a.useEffect)(()=>{(async()=>{try{s(!0);let{claims:e}=await (0,l.Oh)(c);console.log("Fetched claims for kanban:",e);let r=[],n=e.map(e=>(0,l.PD)(e.id).then(t=>({claim:e,appointments:t.appointments})).catch(t=>(console.error("Failed to fetch appointments for claim ".concat(e.id,":"),t),{claim:e,appointments:[]})));(await Promise.all(n)).forEach(e=>{let{claim:t,appointments:n}=e;if(n.length>0)n.forEach(e=>{var n,a,o,s;let i={confirmed:"confirmed",pending:"pending",cancelled:"canceled",canceled:"canceled"}[null===(n=e.status)||void 0===n?void 0:n.toLowerCase()]||"pending";r.push({name:(null===(a=t.insured)||void 0===a?void 0:a.name)||"Unknown",claimNumber:t.claimNumber,policyNumber:t.policyNumber||"N/A",carrier:t.carrier||"N/A",stage:t.stage,peril:t.peril||"Unknown",location:(null===(o=e.location)||void 0===o?void 0:o.address)||(null===(s=t.lossLocation)||void 0===s?void 0:s.address)||"Unknown Location",priorityScore:t.priorityScore,hasAppointment:!0,appointmentDate:new Date(e.start).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),appointmentTime:new Date(e.start).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),appointmentStatus:i,notes:e.notes?[e.notes]:[]})});else{var a,o;r.push({name:(null===(a=t.insured)||void 0===a?void 0:a.name)||"Unknown",claimNumber:t.claimNumber,policyNumber:t.policyNumber||"N/A",carrier:t.carrier||"N/A",stage:t.stage,peril:t.peril||"Unknown",location:(null===(o=t.lossLocation)||void 0===o?void 0:o.address)||"Unknown Location",priorityScore:t.priorityScore,hasAppointment:!1,notes:[]})}}),t(r)}catch(e){console.error("Failed to fetch claims:",e),t([])}finally{s(!1)}})()},[c]),r)?(0,n.jsx)("main",{className:"p-6 max-w-7xl mx-auto",children:(0,n.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Loading claims..."})]})})}):(0,n.jsx)("main",{className:"min-h-screen bg-gray-50",children:(0,n.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Claims Workflow - Kanban View"}),(0,n.jsxs)("nav",{className:"flex gap-4 items-center text-sm",children:[(0,n.jsx)(o.default,{href:"/",className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus:ring-2 focus:ring-gray-500",children:"\uD83D\uDCCA Dashboard View"}),(0,n.jsx)(o.default,{href:"/claims/intake",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500",children:"\uD83C\uDD95 New Claim Intake"})]})]}),(0,n.jsx)(i,{claims:e,onClaimStageUpdate:e=>{t(e)}})]})})}},5591:function(e,t,r){"use strict";async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=await fetch("".concat("/api/proxy").concat(e),{method:t.method||"GET",headers:{"Content-Type":"application/json",...t.headers||{}},body:t.body?JSON.stringify(t.body):void 0,cache:"no-store"});if(!r.ok)throw Error("API ".concat(r.status,": ").concat(await r.text()));return r.json()}async function a(e){let t=new Date(Date.now()-864e5).toISOString();return n("/claims/assignments?adjusterId=".concat(encodeURIComponent(e),"&since=").concat(encodeURIComponent(t)))}async function o(e){return n("/claims/".concat(encodeURIComponent(e),"/appointments"))}r.d(t,{Oh:function(){return a},PD:function(){return o}})}},function(e){e.O(0,[138,971,23,744],function(){return e(e.s=6611)}),_N_E=e.O()}]);